---
argument_specs:
  main:
    short_description: "The main entry point for the mailpit role."
    options:
      mailpit:
        type: dict
        required: true
        description: "Mailpit configuration."
        options:
          domain:
            type: str
            required: false
            description: "The domain name for the Mailpit UI. If not set, defaults to the server's FQDN or IP."
          dehydrated:
            type: dict
            options:
              enable:
                type: bool
                default: true
                description: "Whether to use dehydrated for Let's Encrypt SSL certificates."
          nginx:
            type: dict
            description: "Nginx configuration for Mailpit."
            options:
              enable:
                type: bool
                default: true
                description: "Whether to configure Nginx as a reverse proxy for Mailpit."
              bind_addr:
                type: list
                elements: str
                default:
                  - "127.0.0.1"
                  - "[::1]"
                description: "List of IP addresses Nginx should listen on."
          bind_addr:
            type: str
            default: "127.0.0.1"
            description: "The IP address Mailpit should bind for the UI and SMTP."
          smtp_port:
            type: int
            default: 1025
            description: "The port Mailpit should listen on for SMTP traffic."
          ui_port:
            type: int
            default: 8025
            description: "The port Mailpit should listen on for the Web UI."
          oauth2_proxy:
            type: str
            required: false
            description: "Name of the oauth2_proxy instance to use for authentication (optional)."
          install_dir:
            type: str
            default: "/opt/mailpit"
            description: "Directory where Mailpit will be installed (Linux only)"
          version:
            type: str
            default: "{{ mailpit.version }}"
            description: "The version of Mailpit to install (Linux only). Automatically updated by Renovate bot."
          download_url:
            type: str
            description: "Download URL for the Mailpit binary. Generally auto-constructed."
            default: "https://github.com/axllent/mailpit/releases/download/v{{ mailpit.version }}/mailpit-{{ ansible_facts['system'] | lower }}-{{ 'arm64' if ansible_facts['architecture'] == 'aarch64' else 'amd64' }}.tar.gz"
          db_path:
            type: str
            description: "Path for the mailpit sqlite-database"
            default: "{{ '/var/lib/mailpit/mailpit.db' if ansible_facts['system'] == 'Linux' else '/var/db/mailpit/mailpit.db' }}"
